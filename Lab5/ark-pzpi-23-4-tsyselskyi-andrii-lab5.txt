Харківський національний університет радіоелектроніки
Факультет комп’ютерних наук
Катедра програмної інженерії


Звіт
з лабораторної роботи № 5
з дисципліни «Аналіз та рефакторинг коду»
на тему «Розгортання програмної системи та демонстрація її роботи»




    Виконав:                                                                           Перевірив:
ст. гр. ПЗПІ-23-4                                                              ст. викладач кафедри ПІ
Цисельський Андрій                                            	         Сокорчук Ігор Петрович



Харків 2025
1 ІСТОРІЯ ЗМІН

№ДатаВерсія звітуОпис змін та виправлень120.12.20250.1Зроблено звіт
2 ЗАВДАННЯ
     Метою даної роботи є набуття практичних навичок розгортання програмної системи в робочому середовищі, перевірки її коректної та стабільної функціональності, виконання необхідних початкових і додаткових налаштувань. У процесі виконання роботи передбачається детальне ознайомлення з етапами запуску системи, аналіз її поведінки під час роботи, виявлення можливих помилок та способів їх усунення. Окрему увагу приділено демонстрації роботи програмної системи, а також її коректному документуванню для подальшого використання, супроводу та масштабування.
3 ОПИС ВИКОНАНОЇ РОБОТИ
     Темою проєкту для виконання лабораторних робіт є програмна система для зберігання та видачі пігулок у медичних закладах. 
     Розгортання системи здійснюється з використанням технології контейнеризації Docker, що дозволяє забезпечити ізольоване, відтворюване та незалежне від середовища виконання розгортання застосунку. Для локальної розробки та запуску сервісів використовується Docker Compose. Система побудована на основі веб-фреймворку ASP.NET Core та запускається у середовищі .NET 8.0.
     Для створення Docker-образу використовується файл Dockerfile із застосуванням техніки “multi-stage build”, що дозволяє оптимізувати розмір фінального образу та відокремити етап збірки від етапу виконання (Додаток В).
     Перший етап (build) — збірка застосунку:
- базовим образом обрано офіційний образ “mcr.microsoft.com/dotnet/sdk:8.0”, який містить усі необхідні інструменти для компіляції .NET-застосунку;
-  	встановлення робочої директорії “/src”;
- 	копіювання файлів проектів (.csproj) для кожного шару архітектури: SafeDose.API, SafeDose.Application, SafeDose.Infrastructure, SafeDose.Domain, SafeDose.Identity та SafeDose.Persistence;
- 	відновлення залежностей за допомогою команди “dotnet restore”;
-	 копіювання вихідного коду проєкту в контейнер;
- 	публікація застосунку у Release-конфігурації до директорії “/app/publish”.
     Другий етап (runtime) — створення фінального образу:
- базовим образом обрано легковісний образ “mcr.microsoft.com/dotnet/aspnet:8.0”, який містить лише середовище виконання ASP.NET Core;
- 	встановлення робочої директорії “/app”;
- 	відкриття порту 8080 для HTTP-трафіку;
- 	копіювання опублікованих файлів із етапу збірки;
- 	 точки входу для запуску застосунку командою “dotnet SafeDose.API.dll”.
     Таким чином, Docker-образ містить лише необхідні залежності для коректної роботи ASP.NET Core застосунку, що значно зменшує його розмір порівняно з образом, що містить SDK.
     Керування контейнерами за допомогою Docker Compose
     Для керування контейнерами використовується файл “docker-compose.yaml”, у якому описано два сервіси: sqlserver та api (Додаток В).
     Сервіс sqlserver — база даних Microsoft SQL Server:
- “image” — використання офіційного образу “mcr.microsoft.com/mssql/server:2022-latest”;
- 	“environment” — налаштування пароля адміністратора та прийняття ліцензійної угоди;
- 	“ports” — переброс порту 1433 контейнера на порт 1433 хост-машини;
- 	“volumes” — монтування томів для збереження даних бази та резервних копій;
- 	“healthcheck” — перевірка готовності бази даних за допомогою SQL-запиту перед запуском залежних сервісів.
     Сервіс api — веб-застосунок SafeDose:
- 	“build” — створення образу на основі Dockerfile;
- 	“depends_on” — залежність від сервісу sqlserver з умовою перевірки здоров'я (service_healthy);
-	“environment” — налаштування змінних середовища, включаючи рядок підключення до бази даних;
- 	“ports” — переброс порту 8080 контейнера на порт 8080 хост-машини.
     Використання Docker Compose дозволяє централізовано керувати конфігурацією сервісів та значно спрощує процес локального запуску і тестування системи.
     Розгортання у хмарному середовищі Microsoft Azure
     Для розгортання серверної частини системи у продакшн-середовищі було обрано хмарну платформу Microsoft Azure. Основними причинами такого вибору є надійність інфраструктури, широкий спектр керованих сервісів, інтеграція з екосистемою .NET та гнучкі можливості масштабування.
     Архітектура розгортання включає наступні компоненти Azure:
     Azure SQL Database — керована реляційна база даних:
- 	повна сумісність із Microsoft SQL Server;
- 	автоматичне резервне копіювання та відновлення;
- 	вбудоване шифрування даних;
- 	автоматичне масштабування продуктивності;
- 	висока доступність без додаткового налаштування.
     Azure Container Registry (ACR) — приватний реєстр Docker-образів:
     - 	безпечне зберігання Docker-образів застосунку;
- 	інтеграція з Azure Container Apps для автоматичного розгортання;
- 	підтримка geo-реплікації для зменшення затримок;
- 	сканування образів на вразливості.
     Azure Container Apps — платформа для запуску контейнеризованих застосунків:
-  розгортання веб-застосунків без необхідності ручного налаштування серверів;
- 	автоматичне масштабування на основі навантаження (включаючи масштабування до нуля);
- 	вбудоване балансування навантаження та HTTPS;
- 	автоматичний перезапуск сервісу у разі збоїв;
- 	керування змінними середовища та секретами через Azure Portal.
     База даних
     Для зберігання даних система використовує реляційну базу даних Microsoft SQL Server, яка добре інтегрується з ASP.NET Core через Entity Framework Core ORM. Причини вибору реляційної бази даних:
- 	підтримка складних зв'язків між сутностями;
- 	забезпечення цілісності даних через транзакції та обмеження;
- 	зручна міграція структури бази даних за допомогою EF Core Migrations;
- 	надійність та масштабованість;
- 	розширені можливості для роботи з даними (збережені процедури, тригери, індекси).
     Використання Azure SQL Database як керованого сервісу зменшує складність адміністрування та забезпечує високу доступність.
     Протокол взаємодії
     Для взаємодії між клієнтом і сервером використовується протокол HTTP/HTTPS, який є стандартом для веб-застосунків. Основні переваги використання HTTP/HTTPS:
- 	сумісність з веб-браузерами та мобільними клієнтами;
- 	підтримка REST API;
- 	можливість захищеного передавання даних через HTTPS;
- 	простота інтеграції з зовнішніми сервісами.
     Обмін даними здійснюється у форматі JSON, що є легким, читабельним та зручним для обробки.
     Отже, використання Docker дозволяє ізолювати застосунок разом із залежностями та середовищем виконання. Це значно зменшує ризик помилок, пов'язаних із відмінностями середовищ, та забезпечує однакову поведінку системи в локальному та продакшн-середовищах.
     Обраний стек технологій (Docker, ASP.NET Core, Entity Framework Core, Azure Container Apps, Azure SQL Database, HTTP/HTTPS) забезпечує надійне, масштабоване та зручне розгортання системи SafeDose.
     
4 ВИСНОВКИ
     У ході виконання даної роботи було успішно опановано процес розгортання програмної системи, проведено перевірку її працездатності та здійснено необхідні налаштування для забезпечення коректної роботи. Отримані результати підтверджують правильність виконаних дій та стабільність функціонування системи. Також було набуто досвіду демонстрації роботи програмного продукту та оформлення технічної документації, що є важливим етапом у життєвому циклі програмного забезпечення. Загалом, виконання роботи сприяло поглибленню практичних знань і навичок, необхідних для ефективної роботи з програмними системами в реальних умовах.
5 ВИКОРИСТАНІ ДЖЕРЕЛА
1. Методичні вказівки до лабораторних робіт з дисципліни «Аналіз та рефакторинг коду програмного забезпечення» (дата звернення: 23.10.2025).
2. Wokwi - World's most advanced ESP32 Simulator. Wokwi - World's most advanced ESP32 Simulator. URL: https://wokwi.com/ (дата звернення: 23.12.2025).















ДОДАТОК А
Відеозапис
Відеозапис презентації результатів лабораторної роботи: https://youtu.be/AAe_HGrtJ9Q
Хронологічний опис відеозапису:
00:00 – Вступ 
00:44 – Опис виконаної роботи 
06:12 – Перевірка контейнерізації 
07:20 – Розгляд Azure 
13:00 – Прошивка пристрою














ДОДАТОК В
Програмний код
GitHub репозиторій: https://github.com/NureTsyselskyiAndrii/ark-pzpi-23-4-tsyselskyi-andrii/blob/main/Lab5/ark-pzpi-23-4-tsyselskyi-andrii-lab5
В.1 Код Dockerfile.
1. FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build
2. WORKDIR /src
3. 
4. COPY ["SafeDose.API/SafeDose.API.csproj", "SafeDose.API/"]
5. COPY ["SafeDose.Application/SafeDose.Application.csproj", "SafeDose.Application/"]
6. COPY ["SafeDose.Infrastructure/SafeDose.Infrastructure.csproj", "SafeDose.Infrastructure/"]
7. COPY ["SafeDose.Domain/SafeDose.Domain.csproj", "SafeDose.Domain/"]
8. COPY ["SafeDose.Identity/SafeDose.Identity.csproj", "SafeDose.Identity/"]
9. COPY ["SafeDose.Persistence/SafeDose.Persistence.csproj", "SafeDose.Persistence/"]
10. 
11. RUN dotnet restore "SafeDose.API/SafeDose.API.csproj"
12. 
13. COPY . .
14. WORKDIR "/src/SafeDose.API"
15. RUN dotnet publish -c Release -o /app/publish
16. 
17. FROM mcr.microsoft.com/dotnet/aspnet:8.0
18. WORKDIR /app
19. EXPOSE 8080
20. 
21. COPY --from=build /app/publish .
22. 
23. ENTRYPOINT ["dotnet", "SafeDose.API.dll"]

В.2 Код docker-compose.yaml.
1. version: "3.9"
2. 
3. services:
4.   sqlserver:
5.     image: mcr.microsoft.com/mssql/server:2022-latest
6.     container_name: safedose-sql
7.     environment:
8.       SA_PASSWORD: ${SA_PASSWORD}
9.       ACCEPT_EULA: "Y"
10.     ports:
11.       - "1433:1433"
12.     volumes:
13.       - sql_data:/var/opt/mssql
14.       - ./docker/db:/backup
15.     healthcheck:
16.       test: ["CMD-SHELL", '/opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P "$SA_PASSWORD" -C -Q "SELECT 1" || exit 1']
17.       interval: 10s
18.       timeout: 5s
19.       retries: 10
20.       start_period: 30s
21. 
22.   api:
23.     build:
24.       context: .
25.       dockerfile: SafeDose.API/Dockerfile
26.     container_name: safedose-api
27.     depends_on:
28.       sqlserver:
29.         condition: service_healthy
30.     environment:
31.       ASPNETCORE_ENVIRONMENT: Development
32.       ConnectionStrings__DefaultConnection: ${DB_CONNECTION}
33.     ports:
34.       - "8080:8080"
35. 
36. volumes:
37.   sql_data:


2










